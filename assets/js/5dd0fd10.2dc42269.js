"use strict";(self.webpackChunkdfir_playbooks_and_wiki=self.webpackChunkdfir_playbooks_and_wiki||[]).push([[5868],{3905:(e,t,a)=>{a.d(t,{Zo:()=>m,kt:()=>d});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),p=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},m=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},u="mdxType",k={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,l=e.originalType,s=e.parentName,m=o(e,["components","mdxType","originalType","parentName"]),u=p(a),c=r,d=u["".concat(s,".").concat(c)]||u[c]||k[c]||l;return a?n.createElement(d,i(i({ref:t},m),{},{components:a})):n.createElement(d,i({ref:t},m))}));function d(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=a.length,i=new Array(l);i[0]=c;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o[u]="string"==typeof e?e:r,i[1]=o;for(var p=2;p<l;p++)i[p]=a[p];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}c.displayName="MDXCreateElement"},7212:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>u,frontMatter:()=>l,metadata:()=>o,toc:()=>p});var n=a(7462),r=(a(7294),a(3905));const l={},i="Incident Response Playbook Short - Ransomware Infection",o={unversionedId:"playbooks/Ransomware/ransomware-playbook-short",id:"playbooks/Ransomware/ransomware-playbook-short",title:"Incident Response Playbook Short - Ransomware Infection",description:"Metadata",source:"@site/docs/playbooks/Ransomware/ransomware-playbook-short.md",sourceDirName:"playbooks/Ransomware",slug:"/playbooks/Ransomware/ransomware-playbook-short",permalink:"/docs/playbooks/Ransomware/ransomware-playbook-short",draft:!1,editUrl:"https://github.com/Explie/DFIR-playbooks-and-wiki/blob/main/docs/playbooks/Ransomware/ransomware-playbook-short.md",tags:[],version:"current",frontMatter:{},sidebar:"playbooks",previous:{title:"Incident Response Playbook - DoS and DDoS Attacks",permalink:"/docs/playbooks/DoS/dos_ddos-playbook"},next:{title:"Incident Response Playbook - Ransomware Infection",permalink:"/docs/playbooks/Ransomware/ransomware-playbook"}},s={},p=[{value:"Metadata",id:"metadata",level:2},{value:"Safeguards",id:"safeguards",level:2},{value:"Preparation",id:"preparation",level:2},{value:"Detection / Discovery",id:"detection--discovery",level:2},{value:"Containment / Mitigation",id:"containment--mitigation",level:2},{value:"Analysis",id:"analysis",level:2},{value:"Remediation",id:"remediation",level:2},{value:"Recovery",id:"recovery",level:2},{value:"Post Morten",id:"post-morten",level:2}],m={toc:p};function u(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,n.Z)({},m,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"incident-response-playbook-short---ransomware-infection"},"Incident Response Playbook Short - Ransomware Infection"),(0,r.kt)("h2",{id:"metadata"},"Metadata"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null}),(0,r.kt)("th",{parentName:"tr",align:null}))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"ID")),(0,r.kt)("td",{parentName:"tr",align:null},"IR-EN-001")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"Title")),(0,r.kt)("td",{parentName:"tr",align:null},"Incident Response Playbook Short - Ransomware Infection")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"Last Modified")),(0,r.kt)("td",{parentName:"tr",align:null},"2021-01-22")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"Status")),(0,r.kt)("td",{parentName:"tr",align:null},"Draft")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"Created")),(0,r.kt)("td",{parentName:"tr",align:null},"2021-01-19")))),(0,r.kt)("h2",{id:"safeguards"},"Safeguards"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Patch Management"),(0,r.kt)("li",{parentName:"ul"},"Endpoint Protection"),(0,r.kt)("li",{parentName:"ul"},"Network segmentation"),(0,r.kt)("li",{parentName:"ul"},"Backup Strategy",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Off-Site/ Offline"),(0,r.kt)("li",{parentName:"ul"},"Backup-Server not in domain"),(0,r.kt)("li",{parentName:"ul"},"Regulary (grandfather-father-son)"),(0,r.kt)("li",{parentName:"ul"},"Test from time to time"))),(0,r.kt)("li",{parentName:"ul"},"Restrict administrative accounts"),(0,r.kt)("li",{parentName:"ul"},"Security Appliances in place",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Firewall"),(0,r.kt)("li",{parentName:"ul"},"IDS"),(0,r.kt)("li",{parentName:"ul"},"Mail Security"),(0,r.kt)("li",{parentName:"ul"},"Managed Endpoint Protection"),(0,r.kt)("li",{parentName:"ul"},"Web-Proxy"))),(0,r.kt)("li",{parentName:"ul"},"Endpoint Hardening",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"hardening checklists (CIS)"),(0,r.kt)("li",{parentName:"ul"},"Remove old and unpatched systems "),(0,r.kt)("li",{parentName:"ul"},"Disable SMBv1, Disable SNMP version 1 and 2, disable Windows script host, disable office makros"),(0,r.kt)("li",{parentName:"ul"},"Restrict internet access for all systems"))),(0,r.kt)("li",{parentName:"ul"},"Secure VPN-Access",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Certificates"),(0,r.kt)("li",{parentName:"ul"},"MFA")))),(0,r.kt)("h2",{id:"preparation"},"Preparation"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Network orchestration tools",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Hardware inventory"),(0,r.kt)("li",{parentName:"ul"},"Software inventory"),(0,r.kt)("li",{parentName:"ul"},"Software rollout"),(0,r.kt)("li",{parentName:"ul"},"Patch orchestration"))),(0,r.kt)("li",{parentName:"ul"},"IoC Scanning possibilities",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"netflow logs"),(0,r.kt)("li",{parentName:"ul"},"Endpoint Protection, THOR, YARA, etc.."))),(0,r.kt)("li",{parentName:"ul"},"Network segmentation"),(0,r.kt)("li",{parentName:"ul"},"Central log storage"),(0,r.kt)("li",{parentName:"ul"},"Enhanced network and systems logging"),(0,r.kt)("li",{parentName:"ul"},"Upfront decisions",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"When to pull the plug"),(0,r.kt)("li",{parentName:"ul"},"Critical business path and invlolved systems"),(0,r.kt)("li",{parentName:"ul"},"Who can make which decisions"),(0,r.kt)("li",{parentName:"ul"},"insurance"),(0,r.kt)("li",{parentName:"ul"},"3rd party support at hand for forensic analysis, IT support (rebuilding systems and networks), public communication,  legal advice... "),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"If and when to pay a ransom")))),(0,r.kt)("li",{parentName:"ul"},"User and service desk awareness")),(0,r.kt)("h2",{id:"detection--discovery"},"Detection / Discovery"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Ransomware notes"),(0,r.kt)("li",{parentName:"ul"},"Encrypted Files"),(0,r.kt)("li",{parentName:"ul"},"Unusual high load"),(0,r.kt)("li",{parentName:"ul"},"Anti-virus or IDS Events"),(0,r.kt)("li",{parentName:"ul"},"Beacon file monitoring "),(0,r.kt)("li",{parentName:"ul"},"User reports"),(0,r.kt)("li",{parentName:"ul"},"Documentation")),(0,r.kt)("h2",{id:"containment--mitigation"},"Containment / Mitigation"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Secure uninfected systems"),(0,r.kt)("li",{parentName:"ul"},"Encapsulation of infected subnets/systems"),(0,r.kt)("li",{parentName:"ul"},"Pausing of infected or potential infected VMs"),(0,r.kt)("li",{parentName:"ul"},"Shutdown of infected or potential infected Systems (Non-VM)"),(0,r.kt)("li",{parentName:"ul"},"Restrict or disable internet connection for infected segments"),(0,r.kt)("li",{parentName:"ul"},"Check Back-Up availability"),(0,r.kt)("li",{parentName:"ul"},"Reset or lock compromised accounts"),(0,r.kt)("li",{parentName:"ul"},"Secure needed data"),(0,r.kt)("li",{parentName:"ul"},"Communication internal and external"),(0,r.kt)("li",{parentName:"ul"},"Documentation")),(0,r.kt)("h2",{id:"analysis"},"Analysis"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Determine the Ransomware/Malware type",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Ransom notes"),(0,r.kt)("li",{parentName:"ul"},"Changed Background images"),(0,r.kt)("li",{parentName:"ul"},"file endings"),(0,r.kt)("li",{parentName:"ul"},"signiture bits in encrypted files"),(0,r.kt)("li",{parentName:"ul"},"use specialized webservices like NoMoreRansom (",(0,r.kt)("a",{parentName:"li",href:"https://www.nomoreransom.org/crypto-sheriff.php"},"https://www.nomoreransom.org/crypto-sheriff.php"),") or ID-Ransomware (",(0,r.kt)("a",{parentName:"li",href:"https://id-ransomware.malwarehunterteam.com/"},"https://id-ransomware.malwarehunterteam.com/"),")"),(0,r.kt)("li",{parentName:"ul"},"if nothing helps (",(0,r.kt)("a",{parentName:"li",href:"https://www.bleepingcomputer.com/forums/f/239/ransomware-help-tech-support/"},"https://www.bleepingcomputer.com/forums/f/239/ransomware-help-tech-support/"),")"),(0,r.kt)("li",{parentName:"ul"},"get a sample from the malware"),(0,r.kt)("li",{parentName:"ul"},"determine decrpytion possibilities"),(0,r.kt)("li",{parentName:"ul"},"determine common Indicators of compromise"))),(0,r.kt)("li",{parentName:"ul"},"Determine the attack vector",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Phishing Mails"),(0,r.kt)("li",{parentName:"ul"},"Attached removable devices"),(0,r.kt)("li",{parentName:"ul"},"Vulnerable systems"),(0,r.kt)("li",{parentName:"ul"},"Unusual events in general"),(0,r.kt)("li",{parentName:"ul"},"Open networks"),(0,r.kt)("li",{parentName:"ul"},"Social engineering"))),(0,r.kt)("li",{parentName:"ul"},"Gather information about the malware that was deployed and theire damage potential",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"get a sample and analyze it"),(0,r.kt)("li",{parentName:"ul"},"learn from earlier analysis of the same malware family"))),(0,r.kt)("li",{parentName:"ul"},"Determine the scope of the attack",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Scan network for IoCs (identification of infected systems)"),(0,r.kt)("li",{parentName:"ul"},"Identifiy breached data"),(0,r.kt)("li",{parentName:"ul"},"Indentify exposure of PII"),(0,r.kt)("li",{parentName:"ul"},"Check backups"))),(0,r.kt)("li",{parentName:"ul"},"Check for backdoors"),(0,r.kt)("li",{parentName:"ul"},"Documentation")),(0,r.kt)("h2",{id:"remediation"},"Remediation"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Close the attack vector"),(0,r.kt)("li",{parentName:"ul"},"Patching"),(0,r.kt)("li",{parentName:"ul"},"IoC search the whole infrastructure"),(0,r.kt)("li",{parentName:"ul"},"Remove backdoors and other malware from the systems"),(0,r.kt)("li",{parentName:"ul"},"Adjust Firewall / IDS / AV"),(0,r.kt)("li",{parentName:"ul"},"Documentation")),(0,r.kt)("h2",{id:"recovery"},"Recovery"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Rebuild or cleanse infected systems in a new network zone"),(0,r.kt)("li",{parentName:"ul"},"rebuild the domain"),(0,r.kt)("li",{parentName:"ul"},"Recover data from known good backups"),(0,r.kt)("li",{parentName:"ul"},"Pay the ransom (if no other way can be found)"),(0,r.kt)("li",{parentName:"ul"},"Address colleteral damage"),(0,r.kt)("li",{parentName:"ul"},"Documentation")),(0,r.kt)("h2",{id:"post-morten"},"Post Morten"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Review the incident response process "),(0,r.kt)("li",{parentName:"ul"},"Discuss security enhancements"),(0,r.kt)("li",{parentName:"ul"},"Conduct external reviews")))}u.isMDXComponent=!0}}]);